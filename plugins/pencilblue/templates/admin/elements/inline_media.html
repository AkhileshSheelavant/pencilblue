<div ng-controller="InlineMediaController">
    <div class="panel panel-default">
        <div class="panel-heading">^loc_RELATED_MEDIA^...</div>
        <div class="panel-body" style="min-height: 50px" sortable="board.dragControlListeners" ng-model="editingObject[variablePrefix + '_media']">
            <span class="draggable_item" ng-repeat="mediaItem in editingObject[variablePrefix + '_media'] track by mediaItem._id" sortable-item sortable-item-handle>
                <i class="fa fa-{{mediaItem.icon}}"></i>&nbsp;
                <span ng-bind="mediaItem.name"></span>
                <span ng-bind="': ' + mediaItem.caption" ng-if="mediaItem.caption"></span>
            </span>
        </div>
    </div>
    <div class="panel panel-default">
        <div class="panel-heading">
            <div style="padding-bottom: .5em">^loc_UNRELATED_MEDIA^...</div>
            <div class="input-group">
                <input type="text" id="media_search" name="media_search" class="form-control" placeholder="^loc_NARROW_RESULTS^..."></input>
                <span class="input-group-btn">
                    <button id="media_search_button" class="btn btn-default" type="button"><i class="fa fa-search"></i></button>
                </span>
            </div>
        </div>
        <div class="panel-body" style="min-height: 50px">
            <div  sortable="board.dragControlListeners" ng-model="media">
                <span class="draggable_item" ng-repeat="mediaItem in media track by mediaItem._id" sortable-item sortable-item-handle>
                    <i class="fa fa-{{mediaItem.icon}}"></i>&nbsp;
                    <span ng-bind="mediaItem.name"></span>
                    <span ng-bind="': ' + mediaItem.caption" ng-if="mediaItem.caption"></span>
                </span>
            </div>
        </div>
    </div>
    <div class="form-group">
        <button type="button" class="btn btn-info" ng-click="showMediaModal(false)">
            <i class="fa fa-link"></i>&nbsp;^loc_LINK_TO_MEDIA^...
        </button>
        <button type="button" class="btn btn-info" ng-click="showMediaModal(true)">
            <i class="fa fa-upload"></i>&nbsp;^loc_UPLOAD_MEDIA^...
        </button>
    </div>
    <div class="modal fade" id="media_modal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header" ng-if="addedMedia.isFile">
                    ^loc_UPLOAD_MEDIA^
                </div>
                <div class="modal-header" ng-if="!addedMedia.isFile">
                    ^loc_LINK_TO_MEDIA^
                </div>
                <div class="modal-body">
                    <span ng-if="addedMedia.isFile">
                        <div id="upload_progress" class="progress progress-striped active" style="display: none"><div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div>
                        <span class="btn btn-success fileinput-button">
                            <i class="fa fa-plus"></i>
                            <span>^loc_SELECT_FILE^...</span>
                            <input id="media_file" type="file" name="media_file" accept=".jpg,.jpeg,.png,.gif,.svg,.webp,.mp4,.webm,.ogv">
                        </span>
                    </span>
                    <span ng-if="!addedMedia.isFile">
                        <div class="form-group">
                            <label>^loc_MEDIA_URL^</label>
                            <input type="url" id="media_url" name="media_url" class="form-control" placeholder="^loc_MEDIA_URL_PLACEHOLDER^"></input>
                        </div>
                        <div id="link_loading" class="progress progress-striped active" style="display: none"><div class="progress-bar" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%"></div></div>
                        <button type="button" id="link_button" class="btn btn-primary" onclick="validateMediaURL($('#media_url').val(), false)">
                            <i class="fa fa-link"></i>&nbsp;^loc_LOAD_LINK^
                        </button>
                    </span>
                    <fieldset>
                        <div class="form-group">
                            <input type="checkbox" ng-model="addedMedia.isFile" style="display:none"></input>
                        </div>
                        <div class="form-group">
                            <input type="text" ng-model="addedMedia.mediaType" style="display:none"></input>
                        </div>
                        <div class="form-group">
                            <input type="text" ng-model="addedMedia.location" style="display:none"></input>
                        </div>
                        <div class="form-group">
                            <input type="text" ng-model="addedMedia.thumb" style="display:none"></input>
                        </div>
                        <div class="form-group">
                            <input type="text" ng-model="addedMedia.topics" style="display:none"></input>
                        </div>
                        <div id="media_display" class="form-group"></div>
                        <div class="form-group">
                            <label>^loc_MEDIA_NAME^</label>
                            <input type="text" ng-model="addedMedia.name" class="form-control"></input>
                        </div>
                        <div class="form-group">
                            <label>^loc_CAPTION^</label>
                            <input type="text" ng-model="addedMedia.caption" class="form-control"></input>
                        </div>
                        <button type="button" class="btn btn-default" data-dismiss="modal">
                            <i class="fa fa-ban"></i>&nbsp;^loc_CANCEL^
                        </button>
                        <button type="button" class="btn btn-primary" ng-click="saveAddedMedia()" disabled>
                            <i class="fa fa-save"></i>&nbsp;^loc_SAVE^
                        </button>
                    <fieldset>
                </div>
            </div>
        </div>
    </div>
</div>
^tmp_angular=admin=elements=inline_media^
